<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Browse and search D&D 5th Edition content with offline support">
    <meta name="theme-color" content="#8b4513">
    <title>D&D 5e Lookup Tool</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='80' font-size='80'>üêâ</text></svg>">
</head>
<body>
    <div class="parchment-background">
        <div class="container">
            <header class="header">
                <h1 class="title">
                    <span class="dragon-icon">üêâ</span>
                    D&D 5e Lookup Tool
                    <span class="dragon-icon">üêâ</span>
                </h1>
                <p class="subtitle">Explore the realms of Dungeons & Dragons 5th Edition</p>
                <div class="header-controls">
                    <button id="darkModeToggle" class="control-btn" title="Toggle Dark Mode">
                        üåô Dark Mode
                    </button>
                    <button id="favoritesBtn" class="control-btn" title="View Favorites">
                        ‚≠ê Favorites (<span id="favCount">0</span>)
                    </button>
                    <button id="compareBtn" class="control-btn hidden" title="Compare Selected">
                        üîÑ Compare (<span id="compareCount">0</span>)
                    </button>
                    <button id="installBtn" class="control-btn hidden" title="Install App">
                        üì• Install
                    </button>
                    <button id="diceRollerBtn" class="control-btn" title="Dice Roller">
                        üé≤ Dice
                    </button>
                    <button id="spellSlotsBtn" class="control-btn" title="Spell Slots Tracker">
                        ‚ú® Slots
                    </button>
                    <button id="initiativeBtn" class="control-btn" title="Initiative Tracker">
                        ‚öîÔ∏è Initiative
                    </button>
                    <span id="offlineIndicator" class="offline-indicator hidden" title="Offline Mode">
                        üì° Offline
                    </span>
                </div>
            </header>

            <!-- Quick Access Section -->
            <div id="quickAccessSection" class="quick-access hidden" style="margin: 20px 0; padding: 15px; background: linear-gradient(135deg, var(--dark-parchment) 0%, var(--parchment) 100%); border: 2px solid var(--border); border-radius: 10px;">
                <h3 style="margin: 0 0 10px 0; color: var(--accent);">‚ö° Quick Access</h3>
                <div id="pinnedItems" style="display: flex; gap: 8px; flex-wrap: wrap;"></div>
                <details style="margin-top: 10px;">
                    <summary style="cursor: pointer; color: var(--accent); font-weight: bold;">üìú Recent Items</summary>
                    <div id="recentItems" style="margin-top: 8px; display: flex; gap: 8px; flex-wrap: wrap;"></div>
                </details>
            </div>

            <div class="search-section">
                <div class="category-selector" role="tablist" aria-label="Content categories">
                    <button class="category-btn active" data-category="spells" role="tab" aria-selected="true" aria-controls="results">
                        <span class="icon" aria-hidden="true">‚ú®</span>
                        Spells
                    </button>
                    <button class="category-btn" data-category="monsters" role="tab" aria-selected="false" aria-controls="results">
                        <span class="icon" aria-hidden="true">üëπ</span>
                        Monsters
                    </button>
                    <button class="category-btn" data-category="classes" role="tab" aria-selected="false" aria-controls="results">
                        <span class="icon" aria-hidden="true">‚öîÔ∏è</span>
                        Classes
                    </button>
                    <button class="category-btn" data-category="races" role="tab" aria-selected="false" aria-controls="results">
                        <span class="icon" aria-hidden="true">üë§</span>
                        Races
                    </button>
                    <button class="category-btn" data-category="equipment" role="tab" aria-selected="false" aria-controls="results">
                        <span class="icon" aria-hidden="true">üõ°Ô∏è</span>
                        Equipment
                    </button>
                    <button class="category-btn" data-category="magic-items" role="tab" aria-selected="false" aria-controls="results">
                        <span class="icon" aria-hidden="true">üíé</span>
                        Magic Items
                    </button>
                </div>

                <div class="search-bar">
                    <input type="text" id="searchInput" class="search-input" placeholder="Search for spells, monsters, classes..." aria-label="Search content">
                    <button id="searchBtn" class="search-btn" aria-label="Search">üîç Search</button>
                    <button id="randomBtn" class="search-btn random-btn" title="Get Random Item" aria-label="Get random item">üé≤ Random</button>
                </div>

                <div id="filterSection" class="filter-section hidden"></div>
            </div>

            <div id="loading" class="loading hidden" role="status" aria-live="polite">
                <div class="spinner"></div>
                <p>Consulting the ancient tomes...</p>
            </div>

            <div id="error" class="error hidden" role="alert" aria-live="assertive"></div>

            <div id="results" class="results-grid" role="region" aria-label="Search results"></div>

            <div id="detailModal" class="modal hidden" role="dialog" aria-labelledby="modalTitle" aria-modal="true">
                <div class="modal-content">
                    <span class="close-btn" aria-label="Close modal">&times;</span>
                    <div id="modalBody" class="modal-body"></div>
                </div>
            </div>

            <div id="compareModal" class="modal hidden">
                <div class="modal-content compare-modal">
                    <span class="close-btn" id="closeCompare">&times;</span>
                    <h2>Compare Items</h2>
                    <div id="compareBody" class="compare-body"></div>
                </div>
            </div>

            <div id="favoritesModal" class="modal hidden">
                <div class="modal-content">
                    <span class="close-btn" id="closeFavorites">&times;</span>
                    <h2>‚≠ê Your Favorites</h2>
                    <div style="margin: 10px 0; display: flex; gap: 10px; flex-wrap: wrap;">
                        <button onclick="exportFavoritesPDF()" class="control-btn" style="font-size: 0.9rem;">
                            üìÑ Export to PDF
                        </button>
                        <button onclick="exportFavoritesJSON()" class="control-btn" style="font-size: 0.9rem;">
                            üíæ Export JSON
                        </button>
                        <button onclick="importFavoritesJSON()" class="control-btn" style="font-size: 0.9rem;">
                            üì• Import JSON
                        </button>
                    </div>
                    <div id="favoritesBody" class="favorites-body"></div>
                </div>
            </div>

            <footer class="footer">
                <p>Powered by <a href="https://www.dnd5eapi.co/" target="_blank">D&D 5e API</a></p>
                <p>All content is property of Wizards of the Coast</p>
            </footer>
        </div>
    </div>

    <!-- Dice Roller Modal -->
    <div id="diceRollerModal" class="modal hidden" role="dialog" aria-labelledby="diceRollerTitle" aria-modal="true">
        <div class="modal-content">
            <span class="close-btn" id="closeDiceRoller" aria-label="Close modal">&times;</span>
            <h2 id="diceRollerTitle">üé≤ Dice Roller</h2>
            <div class="dice-roller-body">
                <div class="dice-buttons">
                    <button class="dice-btn" data-dice="d4">d4</button>
                    <button class="dice-btn" data-dice="d6">d6</button>
                    <button class="dice-btn" data-dice="d8">d8</button>
                    <button class="dice-btn" data-dice="d10">d10</button>
                    <button class="dice-btn" data-dice="d12">d12</button>
                    <button class="dice-btn" data-dice="d20">d20</button>
                    <button class="dice-btn" data-dice="d100">d100</button>
                </div>
                <div class="dice-options">
                    <label>Number of dice: <input type="number" id="diceCount" value="1" min="1" max="20"></label>
                    <label>Modifier: <input type="number" id="diceModifier" value="0" step="1"></label>
                    <label>
                        <input type="checkbox" id="advantageCheck"> Advantage
                    </label>
                    <label>
                        <input type="checkbox" id="disadvantageCheck"> Disadvantage
                    </label>
                </div>
                <div id="diceResults" class="dice-results"></div>
                <div id="diceHistory" class="dice-history"></div>
            </div>
        </div>
    </div>

    <!-- Spell Slots Tracker Modal -->
    <div id="spellSlotsModal" class="modal hidden" role="dialog" aria-labelledby="spellSlotsTitle" aria-modal="true">
        <div class="modal-content">
            <span class="close-btn" id="closeSpellSlots" aria-label="Close modal">&times;</span>
            <h2 id="spellSlotsTitle">‚ú® Spell Slots Tracker</h2>
            <div class="spell-slots-body">
                <div class="spell-slots-controls">
                    <label>Character Level: 
                        <select id="characterLevel">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                            <option value="11">11</option>
                            <option value="12">12</option>
                            <option value="13">13</option>
                            <option value="14">14</option>
                            <option value="15">15</option>
                            <option value="16">16</option>
                            <option value="17">17</option>
                            <option value="18">18</option>
                            <option value="19">19</option>
                            <option value="20">20</option>
                        </select>
                    </label>
                    <button id="resetSpellSlots" class="control-btn">Long Rest (Reset All)</button>
                </div>
                <div id="spellSlotsGrid" class="spell-slots-grid"></div>
            </div>
        </div>
    </div>

    <!-- Initiative Tracker Modal -->
    <div id="initiativeModal" class="modal hidden" role="dialog" aria-labelledby="initiativeTitle" aria-modal="true">
        <div class="modal-content">
            <span class="close-btn" id="closeInitiative" aria-label="Close modal">&times;</span>
            <h2 id="initiativeTitle">‚öîÔ∏è Initiative Tracker</h2>
            <div class="initiative-body">
                <div class="initiative-controls">
                    <input type="text" id="initCreatureName" placeholder="Creature name" aria-label="Creature name">
                    <input type="number" id="initRoll" placeholder="Initiative" min="-10" max="50" aria-label="Initiative value">
                    <input type="number" id="initHP" placeholder="HP (optional)" min="1" aria-label="Hit points">
                    <button id="addInitiative" class="control-btn">Add to Combat</button>
                    <button id="clearInitiative" class="control-btn">Clear All</button>
                    <button id="nextTurn" class="control-btn">Next Turn</button>
                </div>
                <div id="initiativeList" class="initiative-list"></div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
